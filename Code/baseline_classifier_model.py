# -*- coding: utf-8 -*-
"""Baseline_classifier_model.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1YGWTXQ7KEiOa0jtFFCNNZ1cNrk2ozcVm
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import nltk

from google.colab import files
files.upload()

df = pd.read_csv('/content/news_dataset.csv')

df.head()

df.info()

print(df.text.sample().iloc[0])

df.Label.value_counts()

df = df[(df.Label=='REAL') | (df.Label =='FAKE')]

df.Label.value_counts()

import nltk
nltk.download('punkt')
nltk.download('wordnet')
nltk.download('stopwords')
import re
from nltk.tokenize import word_tokenize
from nltk.corpus import stopwords
stop_words = stopwords.words('english')
from nltk.stem import WordNetLemmatizer
lemmatizer = WordNetLemmatizer()

def clean_text(text):
  text = text.lower()
  text = re.sub(r'http\S+|www\S+', '', text)
  text = re.sub(r'@[A-Za-z0-9]+', '', text)
  text = word_tokenize(text)
  text = [t for t in text if t not in stop_words]
  text = [t for t in text if t.isalpha()]
  text = [lemmatizer.lemmatize(t, pos='v') for t in text]
  text = ' '.join(text)
  return text

clean_text(df.text[0])

df.text = df.text.apply(lambda x: clean_text(x))

df.text = df.text.apply(lambda x: np.str_(x))

from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics import confusion_matrix, accuracy_score
import seaborn as sns
import matplotlib.pyplot as plt

X_train, X_test, y_train, y_test = train_test_split(df.text, df.Label, test_size = 0.3, random_state =53)

tfidf = TfidfVectorizer()
tfidf_train = tfidf.fit_transform(X_train)
tfidf_test = tfidf.transform(X_test)

tfidf.get_feature_names()



def evaluate_model(y_test, pred):
  accuracy = accuracy_score(y_test, pred)
  print("Accuracy of the model: ", accuracy)
  cm = confusion_matrix(y_test, pred)
  sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', cbar=False)
  return accuracy

from sklearn.linear_model import LogisticRegression
lr_classifier = LogisticRegression()
lr_classifier.fit(tfidf_train, y_train)
pred = lr_classifier.predict(tfidf_test)

lr_accuracy=evaluate_model(y_test, pred)

print(lr_classifier.predict(tfidf.transform([clean_text('The PM Modi-led government is facing heavy uproar over the newly passed agriculture bills in the Parliament. The three farm bills - The Farmers Produce Trade and Commerce (Promotion and Facilitation) Bill, 2020, The Farmers (Empowerment and Protection) Agreement on Price Assurance and Farm Services Bill, 2020, and The Essential Commodities (Amendment) Bill, were passed in both the houses of the Parliament earlier this week, despite strong protest from farmers and opposition parties. Amidst the ongoing widespread demonstrations against the farm bills, an image of a grain silo owned by Adani Agri Logistics Limited is doing rounds on the internet. The picture is being circulated with a claim that Adani Agri has set up a grain silo in Punjab Moga within days of the passing of farm bills. A silo is a giant steel structure used to store grains for a longer duration. One such claim in the Hindi language uploaded on Twitter translates into English as, “The Bill has gone to the President, the rest is in Parliament but preparations for Adani have already begun. Congress and BJP will leave farmers completely ruined. India Today Anti Fake News War Room (AFWA) has found that the claim along with the image is misleading. Adani Agri Logistics Ltd. is more than a decade old, with commissioned silos in seven cities including Moga in Punjab. Similar misleading claims were also shared on Facebook. The archived versions of similar claims can be seen here, here and here. AFWA probe According to the Adani Agri Logistics official website, the company has been functioning in India since 2007 in collaboration with the Food Corporation of India (FCI). The company runs silos at Moga in Punjab and Kaithal in Haryana to store grains. According to the company, the Indian government recognised difficulties faced by farmers in storing food grains using traditional methods. The government along with FCI called for a global tender for the country’s first modern food grain storage facility in the year 2000. This tender was bagged by the Gujarat-based Adani group. Since 2007, farmers have been delivering their produce at Adani’s silos in Moga and Kaithal, and FCI pays for the farmers. The grains are stored in steel silos to preserve their freshness and quality until they are further transported to field depots and later to open markets, according to FCI instructions. We also found Adani Agri Logistics mentioned in multiple news reports which confirmed that the grain silo in question was not a recent construction. According to a Financial Express report published on October 18, 2008, FCI entered a build, own, and operate (BOO) agreement for 20 years with Adani Agri for setting up silos at Moga and Kaithal in 2005. The report further mentions that the company also has five field depots at Chennai, Coimbatore, Bangalore, Navi Mumbai, and Hoogly. We also found reports on Adani Agri Logistics published by BusinessLine and Mint. The Mint report, published in 2015, also mentions the inception of Adani Agri silo in the year 2007. Hence, it is clear that the Adani Agri Logistics is in existence in India since 2007 and is not a recent development.')])))



